<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>SIUT Links</title>
        <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
        <!-- Bootstrap 3.3.2 -->
        <link href="../alumnos/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <!-- Font Awesome Icons -->
        <!--<link href="dist/css/font-awesome.min.css" rel="stylesheet" type="text/css" />-->
        <!-- Theme style -->
        <link href="../alumnos/res-dist/css/AdminLTE.min.css" rel="stylesheet" type="text/css" />
        <!-- iCheck -->
        <link href="../alumnos/plugins/iCheck/square/grey.css" rel="stylesheet" type="text/css" />
        <link href="../alumnos/res-me/css/main.css" rel="stylesheet" type="text/css" />
        <link type="text/css" rel="Stylesheet" href="../alumnos/res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/styles/jqx.base.css" />
    </head>
    <body class="login-page" style="">
        <div class="login-box">
            <div class="login-logo">
                <span id="logoSiutGreen" style="position: relative; transform: scale(1.5,1.5);">SIUT</span>
            </div><!-- /.login-logo -->
            <div class="login-box">
                <style>
                    .login-box, .register-box {
                        width: 984px;
                        margin: 7% auto;
                    }
                </style>
                <div class="login-box-body">
                    <div style="padding: 20px; display: block">
                        <a class="btn btn-block  btn-success" target="_blank" href="http://10.10.40.4/eQDZPro/Encuestas/Encuestas.aspx?rand=ZXZlbnRvPTcwMDAmZW09MSZjb25uU3RyaW5nPWMyVnlkbVZ5UFZOSlUxUkZUVUZjVTFGTVJWaFFVa1ZUVXp0RVlYUmhZbUZ6WlQxbFVVUmFVSEp2WHpBeE8zVnBaRDFsVVVSYVVISnZPeUJ3ZDJROWIyNTRjSEp2TGpFN0lFMTFiSFJwY0d4bFFXTjBhWFpsVW1WemRXeDBVMlYwY3oxMGNuVmxPdz09JnRpcG9EQj0wJnVpZD0zJmV4dD03MDAwJklkSWRpb21hPTEwJklkRW5jdWVzdGE9Njg1&include=&external=1">PRIMERA EVALUACIÓN DEL SERVICIO DE COMEDOR JUNIO 2016 TSU E INGENIERIA 2DA PARTE</a>
                        <a class="btn btn-block  btn-success" target="_blank" href="http://10.10.40.4/eqdzpro/Encuestas/Encuestas.aspx?rand=ZXZlbnRvPTcwMDAmZW09MSZjb25uU3RyaW5nPWMyVnlkbVZ5UFZOSlUxUkZUVUZjVTFGTVJWaFFVa1ZUVXp0RVlYUmhZbUZ6WlQxbFVVUmFVSEp2WHpBeE8zVnBaRDFsVVVSYVVISnZPeUJ3ZDJROWIyNTRjSEp2TGpFN0lFMTFiSFJwY0d4bFFXTjBhWFpsVW1WemRXeDBVMlYwY3oxMGNuVmxPdz09JnRpcG9EQj0wJnVpZD0zJmV4dD03MDAwJklkSWRpb21hPTEwJklkRW5jdWVzdGE9Njk1&external=1">PRIMERA EVALUACIÓN DE SERVICIOS JUNIO 2016 TSU E INGENIERIA</a>
                        <a class="btn btn-block  btn-success" target="_blank" href="http://10.10.40.4/eqdzpro/Encuestas/Encuestas.aspx?rand=ZXZlbnRvPTcwMDAmZW09MSZjb25uU3RyaW5nPWMyVnlkbVZ5UFZOSlUxUkZUVUZjVTFGTVJWaFFVa1ZUVXp0RVlYUmhZbUZ6WlQxbFVVUmFVSEp2WHpBeE8zVnBaRDFsVVVSYVVISnZPeUJ3ZDJROWIyNTRjSEp2TGpFN0lFMTFiSFJwY0d4bFFXTjBhWFpsVW1WemRXeDBVMlYwY3oxMGNuVmxPdz09JnRpcG9EQj0wJnVpZD0zJmV4dD03MDAwJklkSWRpb21hPTEwJklkRW5jdWVzdGE9NzA1&external=1">PRIMERA EVALUACIÓN DEL SERVICIO MEDICO JUNIO 2016 TSU E INGENIERIA</a>
                        <a class="btn btn-block  btn-success" target="_blank" href="http://10.10.40.4/eqdzpro/Encuestas/Encuestas.aspx?rand=ZXZlbnRvPTcwMDAmZW09MSZjb25uU3RyaW5nPWMyVnlkbVZ5UFZOSlUxUkZUVUZjVTFGTVJWaFFVa1ZUVXp0RVlYUmhZbUZ6WlQxbFVVUmFVSEp2WHpBeE8zVnBaRDFsVVVSYVVISnZPeUJ3ZDJROWIyNTRjSEp2TGpFN0lFMTFiSFJwY0d4bFFXTjBhWFpsVW1WemRXeDBVMlYwY3oxMGNuVmxPdz09JnRpcG9EQj0wJnVpZD0zJmV4dD03MDAwJklkSWRpb21hPTEwJklkRW5jdWVzdGE9NzE1&external=1">PRIMERA EVALUACIÓN DEL SERVICIO DE LOS TALLERES Y LABORATORIOS DE PROCESOS ALIMENTARIOS JUNIO 2016 TSU E INGENIERÍA</a>
                        <a class="btn btn-block  btn-success" target="_blank" href="http://10.10.40.4/eqdzpro/Encuestas/Encuestas.aspx?rand=ZXZlbnRvPTcwMDAmZW09MSZjb25uU3RyaW5nPWMyVnlkbVZ5UFZOSlUxUkZUVUZjVTFGTVJWaFFVa1ZUVXp0RVlYUmhZbUZ6WlQxbFVVUmFVSEp2WHpBeE8zVnBaRDFsVVVSYVVISnZPeUJ3ZDJROWIyNTRjSEp2TGpFN0lFMTFiSFJwY0d4bFFXTjBhWFpsVW1WemRXeDBVMlYwY3oxMGNuVmxPdz09JnRpcG9EQj0wJnVpZD0zJmV4dD03MDAwJklkSWRpb21hPTEwJklkRW5jdWVzdGE9NzI1&external=1">PRIMERA EVALUACIÓN DEL SERVICIO DEL TALLER DE MECATRÓNICA JUNIO 2016 TSU E INGENIERIA</a>
                    </div> 
                </div>
            </div>
        </div><!-- /.login-box -->
        <!-- jQuery 2.1.3 -->
        <script src="plugins/jQuery/jQuery-2.1.3.min.js"></script>        
        <!-- Bootstrap 3.3.2 JS -->
        <script src="bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        <!-- iCheck -->
        <script src="plugins/iCheck/icheck.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxcore.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxpasswordinput.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxinput.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxvalidator.js"></script>
        <script type="text/javascript" src="res-me/js/purl.js"></script>
        <script>
            $( document ).bind( "mobileinit", function() {
                // Make your jQuery Mobile framework configuration changes here!
                $.mobile.ajaxEnabled = true;
                $.mobile.pushStateEnabled = false;
                $.mobile.allowCrossDomainPages = true;
                $.support.cors = true;
            });
            $(document).ready(function (){
                if (typeof $.url().param('ac') !== 'undefined') { // sent exists
                    $("#formLogin").parent().hide();
                    $.ajax({
                        async: false,
                        crossDomain: true,
                        type: "POST",
                        datatype: "json",
                        url: "http://10.10.25.5/serviceStudent?descryptUrl",
                        data: {
                            "ac" : $.url().param('ac')
                        },
                        beforeSend: function (xhr) {
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            alert("Error interno del servidor");
                        },
                        success: function (data, textStatus, jqXHR) {   
                            $("#formStatusAcountActivate").parent().show();
                            if(data.status==="Success"){
                                $(".msgBoxStatus").html('<b style="font-size: 18px">Muy bien, tu cuenta fue activada exitosamente, ahora podrás iniciar sesión con normalidad</b>');
                                $("#sendButtonStatus").text("Siguiente");
                            }else if(data.status==="linkBroken"){
                                $(".msgBoxStatus").html('<b style="font-size: 18px">El link parece estar dañado :/</b>');
                                $("#sendButtonStatus").text("Ok");
                            }
                        }
                    });
                }else{
                    $("#formLogin").parent().show();
                }
                $(function () {
                    $('input').iCheck({
                        checkboxClass: 'icheckbox_square-grey',
                        radioClass: 'iradio_square-grey',
                        increaseArea: '20%' // optional
                    });
                });
                $("#password").jqxPasswordInput();
                $("#formLogin").jqxValidator({
                    hintType: 'label',
                    animationDuration: 0,
                    rules: [
                        {
                            input: "#enrollment", 
                            message: "Este campo es requerido!", 
                            action: 'keyup, blur', 
                            rule: "required"
                        },
                        {   
                            input: "#password", 
                            message: "La contraseña es necesaria!", 
                            action: 'keyup, blur', 
                            rule: 'required' 
                        }
                    ]
                });
                $(".btn-success").click(function (){
                    if(navigator.vibrate) {
                        navigator.vibrate(20);
                    }
                });
                $("#sendButton").click(function (){
                    $('#formLogin').jqxValidator('validate');
                    return false;
                });
                $('#formLogin').submit(function (){
                    $('#formLogin').jqxValidator('validate');
                    return false;
                });
                $('#formLogin').on('validationSuccess', function (event) {
                    //en el evento submit del fomulario
                    var data = $("#formLogin").serialize(); // los datos del 
                    $.ajax({
                        async: true,
                        crossDomain: true,
                        type: "POST",
                        url: "http://10.10.25.5/serviceStudent?selectLoginStudent",
                        datatype: "json",
                        data: data,
                        beforeSend: function (xhr) {
                            $("#windowBlock").fadeIn("slow");
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            alert("Error interno del servidor");
                            $("#windowBlock").fadeOut("slow");
                        }
                    }).success(function(data){
                        if(data.statusLogin==="notMailActive"){
                            $("#windowBlock").fadeOut("slow");
                            $("#userNameActive").val(data.userNameStudent);
                            $("#emailActive").val(data.mailStudent);
                            $("#userName").val(data.logueadoStudentCal);
                            $("#pkStudent").val(data.pkStudent);
                            $("#passwordActive").val($("#password").val());
                            $("#formLogin").parent().hide();
                            $("#formLoginValidate").parent().show();
                        }else if(data.statusLogin==="logeado"){
                            setTimeout(function(){
                                $("#windowBlock").fadeOut("slow");
                                if(eval(localStorage.getItem("rememberMe"))){
                                    sessionStorage.clear();
                                    localStorage.setItem("session",true);
                                    localStorage.setItem("pkStudent",data.pkStudent);
                                    localStorage.setItem("userNameStudent",data.userNameStudent);
                                    localStorage.setItem("mailStudent",data.mailStudent);
                                    localStorage.setItem("logueadoStudentCal",data.logueadoStudentCal);
                                    localStorage.setItem("nameSmall",data.nameSmall);
                                    localStorage.setItem("careerStudent",data.careerStudent);
                                    localStorage.setItem("genderStudent",data.genderStudent);
                                    localStorage.setItem("nameGroup",data.nameGroup);
                                    localStorage.setItem("pkGroup",data.pkGroup);
                                    localStorage.setItem("fkLevel",data.fkLevel);
                                }else{
                                    localStorage.clear();
                                    sessionStorage.setItem("session",true);
                                    sessionStorage.setItem("pkStudent",data.pkStudent);
                                    sessionStorage.setItem("userNameStudent",data.userNameStudent);
                                    sessionStorage.setItem("mailStudent",data.mailStudent);
                                    sessionStorage.setItem("logueadoStudentCal",data.logueadoStudentCal);
                                    sessionStorage.setItem("nameSmall",data.nameSmall);
                                    sessionStorage.setItem("careerStudent",data.careerStudent);
                                    sessionStorage.setItem("genderStudent",data.genderStudent);
                                    sessionStorage.setItem("nameGroup",data.nameGroup);
                                    sessionStorage.setItem("pkGroup",data.pkGroup);
                                    sessionStorage.setItem("fkLevel",data.fkLevel);
                                }
                                window.location="index.html";
                            }, 2000);
                        }else if(data.statusLogin==="notExit"){
                            $("#windowBlock").fadeOut("slow");
                            $("#MessageError").fadeIn("slow");
                            alert("Verifica tus datos");
                        }
                    }).fail(function(jqXHR, textStatus){
                        alert("[AJAX] Error: JSON WSDL Lookup>>>" + textStatus);
                        console.log("[AJAX] Error: JSON WSDL Lookup>>>" + textStatus);
                    }).done(function(){
                        console.log("[AJAX] Complete: JSON WSDL Lookup");
                    });
                });
                
                $("#formLoginValidate").jqxValidator({
                    hintType: 'label',
                    animationDuration: 0,
                    rules: [
                        {
                            input: "#userNameActive", 
                            message: "Este campo es requerido!", 
                            action: 'keyup, blur', 
                            rule: "required"
                        },
                        {   
                            input: "#emailActive", 
                            message: "El correo es necesario!", 
                            action: 'keyup, blur', 
                            rule: 'required' 
                        },
                        {   
                            input: "#emailActive", 
                            message: "El correo no tiene un formato valido!", 
                            action: 'keyup, blur', 
                            rule: 'email' 
                        }
                    ]
                });
                $("#sendButtonValidate").click(function (){
                    $('#formLoginValidate').jqxValidator('validate');
                    return false;
                });
                $('#formLoginValidate').submit(function (){
                    $('#formLoginValidate').jqxValidator('validate');
                    return false;
                });
                $('#formLoginValidate').on('validationSuccess', function (event) {
                    //en el evento submit del fomulario
                    var datos = $("#formLoginValidate").serialize(); // los datos del 
                    $.ajax({
                        async: true,
                        crossDomain: true,
                        type: "POST",
                        datatype: "json",
                        url: "http://10.10.25.5/serviceMail?validateMail",
                        data: {
                            "pkStudent" : $("#pkStudent").val(),
                            "enrollment": $("#userNameActive").val(),
                            "userName": $("#userName").val(),
                            "email": $("#emailActive").val(),
                            "password" : $("#password").val()
                        },
                        beforeSend: function (xhr) {
                            $("#windowBlock").fadeIn("slow");
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            alert("Error interno del servidor");
                            $("#windowBlock").fadeOut("slow");
                        },
                        success: function (data, textStatus, jqXHR) {
                            $("#windowBlock").hide();
                            if(data.statusSendMail==="Success"){                                
                                $("#formLoginValidate").parent().hide();
                                $("#formStatusSendMail").parent().show();
                            }
                            console.log(datos);
                        }
                    });
                });
                $("#formLoginRemember").jqxValidator({
                    hintType: 'label',
                    animationDuration: 0,
                    rules: [
                        {
                            input: "#nameUserRemember", 
                            message: "Este campo es requerido!", 
                            action: 'keyup, blur', 
                            rule: "required"
                        },
                        {   
                            input: "#mail", 
                            message: "El correo es necesario!", 
                            action: 'keyup, blur', 
                            rule: 'required' 
                        },
                        {   
                            input: "#mail", 
                            message: "El correo parece ser incorrecto", 
                            action: 'keyup, blur', 
                            rule: 'email' 
                        }
                    ]
                });
                $('#formLoginRemember').on('validationSuccess', function (event) {
                    //en el evento submit del fomulario
                    if($("#buttonRemember").text()==="OK"){
                        $("#back").click();
                        $("#buttonRemember").text("Recordar");
                    }else{
                        var datos = $("#formLoginRemember").serialize(); // los datos del 
                        $.ajax({
                            type: "POST",
                            async: true,
                            url: "../serviceMail?rememberPassword",
                            data:datos,
                            beforeSend: function (xhr) {
                                $("#windowBlock").fadeIn("slow");
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                alert("Error interno del servidor");
                                $("#windowBlock").fadeOut("slow");
                            },
                            success: function (data, textStatus, jqXHR) {
                                if(data.statusSendMail==="Success"){
                                    $("#message").text("Se envió correctamente el recordatorio al correo, favor de revisar...");  
                                    $("#buttonRemember").text("OK");
                                }else if(data.statusSendMail==="EmailNotFountForEnrrollment"){
                                    $("#message").text("Lo sentimos los datos no fueron ingresados de forma correcta favor de verificar...");  
                                }else if(data.statusSendMail==="FailConnectionNetwork"){
                                    $("#message").text("Lamentamos que estemos teniendo problemas de conexión favor de intentar mas tarde.");  
                                }else{
                                    $("#message").text("Al parecer el correo que ingreso no es correcto, intenta corregir este problema.");  
                                }
                                $("#windowBlock").fadeOut("slow");
                            }
                        });
                    }
                });
                $("#buttonRemember").click(function (){
                    $('#formLoginRemember').jqxValidator('validate');
                    return false;
                });
                $('#formLoginRemember').submit(function (){
                    $('#formLoginRemember').jqxValidator('validate');
                    return false;
                });
                $("#rememberPass").click(function (){
                    $("#nameUserRemember").val("");
                    $("#mail").val("");
                    $("#formLogin").parent().hide();                            
                    $("#formLoginRemember").parent().show();                       
                });
                $("#back").click(function (){
                    $("#formLogin").parent().show();
                    $("#formLoginRemember").parent().hide();   
                });
                
                $("#sendButtonBack").click(function (){
                    $("#formLogin").parent().show();
                    $("#formLoginValidate").parent().hide();
                });
                if(eval(localStorage.getItem("rememberMe"))){
                    $('#rememberMe').iCheck('check');
                    $("#userName").val(localStorage.getItem("userNameStudent"));
                }else{
                    $('#rememberMe').iCheck('uncheck');
                }                
                $('#rememberMe').on("ifChecked", function (){
                    localStorage.setItem("rememberMe",true);
                    if(navigator.vibrate) {
                        navigator.vibrate(20);
                    }
                });
                $('#rememberMe').on("ifUnchecked", function (){
                    localStorage.setItem("rememberMe",false);
                    if(navigator.vibrate) {
                        navigator.vibrate(20);
                    }
                });
            });
        </script>
    </body>
</html>