<!DOCTYPE html>
<html lang="es" manifest="file.manifest">
    <head>        
        <meta charset="UTF-8">
        <title>AdminSIUT</title>
        <script>
            // Check if a new cache is available on page load.
            window.addEventListener('load', function(e) {
                window.applicationCache.addEventListener('updateready', function(e) {

                    if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
                        // Browser downloaded a new app cache.
                        // Swap it in and reload the page to get the new hotness.
                        window.applicationCache.swapCache();
                        window.location.reload();
                    } else {
                        // Manifest didn't changed. Nothing new to server.
                    }
                }, false);

            }, false);
        </script>
        <script>
            window.location.hash="";
            window.location.hash=""; //chrome
            window.onhashchange=function(){window.location.hash="";};
            if(typeof (Storage) !=="undefined"){
                if(eval(localStorage.getItem("rememberMe"))){
                    if(!eval(localStorage.getItem("session"))){
                        window.location="login.html";                        
                    }
                }else{
                    if(!eval(sessionStorage.getItem("session"))){
                        window.location="login.html";                        
                    }
                }                                 
            }else{
                alert("No es soportado el localStorage");
            }  
            navigator.vibrate = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate;
        </script>
        <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
        <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />    
        <link href="res-dist/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
        <link href="res-dist/css/ionicons.min.css" rel="stylesheet" type="text/css" />       
        <link href="res-dist/css/AdminLTE.min.css" rel="stylesheet" type="text/css" />
        <link href="res-dist/css/skins/skin-green.min.css" rel="stylesheet" type="text/css" />
        <link href="res-me/css/main.css" rel="stylesheet" type="text/css" /> 
        <link href="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/styles/jqx.base.css" rel="stylesheet"/>
<!--        <link href="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/styles/jqx.windowsphone.css" rel="stylesheet"/>
        <link href="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/styles/jqx.blackberry.css" rel="stylesheet"/>
        <link href="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/styles/jqx.android.css" rel="stylesheet"/>-->
        <link href="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/styles/jqx.mobile.css" rel="stylesheet"/>
        <style>
            .cortar{
                text-overflow:ellipsis;
                white-space:nowrap; 
                overflow:hidden; 
            }
        </style>
    </head>
    <body class="skin-green fixed">
        <div id="jqxLoader"></div>
        <div class="wrapper">

          <header class="main-header">
            <!-- Logo -->            
            <a href="#" class="logo"><span id="logoSiutGreen" style="position: relative">SIUT</span></a>               
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top" role="navigation">
              <!-- Sidebar toggle button-->
              <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">Toggle navigation</span>
              </a>
              <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">
                   
                  <!-- Notifications: style can be found in dropdown.less -->
<!--                  <li class="dropdown notifications-menu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                      <i class="fa fa-bell-o"></i>
                      <span class="label label-warning">5</span>
                    </a>
                    <ul class="dropdown-menu">
                      <li class="header">Notificaciones recientes</li>
                      <li>
                         inner menu: contains the actual data 
                        <ul class="menu">
                          <li>
                            <a href="#">
                              La carrera de TIC´S realizará un evento tecnológico el día 12 de mayo del precente año
                            </a>
                          </li>
                          <li>
                            <a href="#">
                              La universidad firma un nuevo convenio con la empresa Oracle
                            </a>
                          </li>
                          <li>
                            <a href="#">
                              Los alumnos de administración realizarán una visita a la empresa Bimbo
                            </a>
                          </li>

                          <li>
                            <a href="#">
                              El equipo de futbol femenino trae con sigo la victoria
                            </a>
                          </li>
                          <li>
                            <a href="#">
                              Todos los maestro de tiempo completo lograron terminar su curso de calidad del servicio
                            </a>
                          </li>
                        </ul>
                      </li>
                      <li class="footer"><a href="#">Ver todas</a></li>
                    </ul>
                  </li>-->
                  <!-- Tasks: style can be found in dropdown.less -->
                  <li class="dropdown tasks-menu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                      <i class="fa fa-flag-o"></i>
                      <span class="label totalMaters label-danger"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li class="header">
                            Tienes <span class="totalMaters"> </span> materias
                            <br>
                            <span>Progreso evaluado por el profesor</span>
                        </li>
                      <li>
                        <!-- inner menu: contains the actual data -->
                        <ul class="menu subjectMatters"></ul>
                      </li>
                      <li class="footer">
                          <a data-href='qualifications-report.html' href='#' class='small-box-footer'>Ir a detalles<i class='fa fa-arrow-circle-right'></i></a>
                      </li>
                    </ul>
                  </li>
                  <!-- User Account: style can be found in dropdown.less -->
                  <li class="dropdown user user-menu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                      <img src="res-dist/img/avatar5.png" class="user-image image-gender" alt="Avatar"/>
                      <span class="hidden-xs nameStudent"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <!-- User image -->
                      <li class="user-header">
                        <img src="res-dist/img/avatar5.png" class="img-circle image-gender" alt="Avatar" />
                        <p>
                            <span class="nameSmallStudent"></span>- Alumno de <span class="career"></span>
                            <small class="enrollment"></small>
                            <small>Grupo: <span class="group"></span></small>
                        </p>
                      </li>
                      <!-- Menu Body -->
                      <!-- Menu Footer-->
                      <li class="user-footer">
<!--                        <div class="pull-left">
                          <a href="#" class="btn btn-default btn-flat">Perfil</a>
                        </div>-->
                        <div class="pull-right">
                            <a id="signOut" href="#" class="btn btn-default btn-flat">Cerrar sesión</a>
                        </div>
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>
            </nav>
          </header>
          <!-- Left side column. contains the logo and sidebar -->
          <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
              <!-- Sidebar user panel -->
              <div class="user-panel">
                <div class="pull-left image">
                  <img src="res-dist/img/avatar5.png" class="img-circle image-gender" alt="User Image" />
                </div>
                <div class="pull-left info">
                    <p class="nameSmallStudent"></p>
                    <a href="#"><i class="fa fa-circle text-success"></i> Alumno</a>
                </div>
              </div>
              
              <!-- sidebar menu: : style can be found in sidebar.less -->
              <ul class="sidebar-menu">
                <li class="header">NAVEGACIÓN PRINCIPAL</li>
                <li class="active treeview">
                  <a href="#">
                    <i class="fa fa-dashboard"></i> <span>Calificaciones</span> <i class="fa fa-angle-left pull-right"></i>
                  </a>
                    <ul class="treeview-menu">
                        <li data-href="qualifications-activities.html">
                            <a href="#"><i class="fa fa-circle-o"></i> Por actividades</a>
                        </li>
                        <li data-href="qualifications-matters.html">
                            <a href="#"><i class="fa fa-circle-o"></i> Por materias</a>
                        </li>
                    </ul>
                </li>
                <li data-href="qualifications-criterion.html"><a href="#"><i class="fa fa-arrow-up"></i>Criterios de evaluación</a></li>
                <li data-href="about.html"><a href="#"><i class="fa fa-book"></i> Acerca de...</a></li>
              </ul>
            </section>
            <!-- /.sidebar -->
          </aside>

          <!-- Content Wrapper. Contains page content -->
          <div class="content-wrapper">
            
          </div><!-- /.content-wrapper -->
          <footer class="main-footer">
            <div class="pull-right hidden-xs">
              <b>Versión</b> 2.1.0
            </div>
            <strong>Copyright &copy; 2015-2016 </strong> Todos los derechos reservados.
          </footer>
        </div><!-- ./wrapper -->

        <!-- jQuery 2.1.3 -->
        <script src="plugins/jQuery/jQuery-2.1.3.min.js"></script>
        
<!--         jQuery UI 1.11.2 
        <script src="dist/js/jquery-ui.min.js" type="text/javascript"></script>
         Resolve conflict in jQuery UI tooltip with Bootstrap tooltip 
        <script>
          $.widget.bridge('uibutton', $.ui.button);
        </script>-->
        <script src="bootstrap/js/bootstrap.min.js" type="text/javascript"></script>    
        <script src="plugins/slimScroll/jquery.slimscroll.min.js" type="text/javascript"></script>
        <script src="res-dist/js/app.min.js" type="text/javascript"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxcore.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxchart.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/localization.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxdata.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxbuttons.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxscrollbar.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxlistbox.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxloader.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/jqxdropdownlist.js"></script>
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/globalization/globalize.js"></script> 
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/jqwidgets/globalization/globalize.cultures.js"></script> 
        <script type="text/javascript" src="res-me/jqwidgets/jqwidgets-ver4.0.0/scripts/get-theme.js"></script>
        <script type="text/javascript" src="res-me/js/make-combo.js"  charset="UTF-8"></script>
        <script>
            if(typeof (Storage) !=="undefined"){                    
                if(eval(localStorage.getItem("rememberMe"))){
                    if(eval(localStorage.getItem("session"))){
                        if(localStorage.getItem("genderStudent")==="Hombre"){
                            $(".image-gender").attr("src", "res-dist/img/avatar5.png"); 
                        }else{
                            $(".image-gender").attr("src", "res-dist/img/avatar2.png"); 
                        }
                        $(".nameStudent").text(localStorage.getItem("logueadoStudentCal"));
                        $(".nameSmallStudent").text(localStorage.getItem("nameSmall"));
                        $(".career").text(localStorage.getItem("careerStudent"));
                        $(".enrollment").text(localStorage.getItem("userNameStudent"));  
                        $(".group").text(localStorage.getItem("nameGroup"));  
                    }
                }else{
                    if(eval(sessionStorage.getItem("session"))){
                        if(eval(sessionStorage.getItem("session"))){
                            if(sessionStorage.getItem("genderStudent")==="Hombre"){
                                $(".image-gender").attr("src", "res-dist/img/avatar5.png"); 
                            }else{
                                $(".image-gender").attr("src", "res-dist/img/avatar2.png"); 
                            }
                            $(".nameStudent").text(sessionStorage.getItem("logueadoStudentCal"));
                            $(".nameSmallStudent").text(sessionStorage.getItem("nameSmall"));
                            $(".career").text(sessionStorage.getItem("careerStudent"));
                            $(".enrollment").text(sessionStorage.getItem("userNameStudent"));    
                             $(".group").text(sessionStorage.getItem("nameGroup"));  
                        }                      
                    }
                }  
            }else{
                alert("No es soportado el localStorage");
            }
            var data = null;
            $(document).ready(function (){
                var itemClickedId;
                var itemClickedIdOld;
                var dirCookie = localStorage.getItem("dirApp");
                
                var source = {
                    datatype: "json",
                    datafields: [
                        { name: 'index'},
                        { name: 'Pk_matter'},
                        { name: 'Materias'},
                        { name: 'Profesor'},
                        { name: 'MateriasAbre'},
                        { name: 'Evaluado'},
                        { name: 'Obtenido'},
                        { name: 'Estado'}
                    ],
                    root:"rows",
                    data:{
                        "pkStudent" : localStorage.getItem("pkStudent") || sessionStorage.getItem("pkStudent")
                    },
                    url: 'http://148.223.215.19/serviceCalification?calMattersStudentChart'
                };
                var dataAdapter = new $.jqx.dataAdapter(source, {
                    async: false,
                    autoBind: true,
                    beforeLoadComplete: function (records) {
                        $(".totalMaters").text(records.length);
                        data=records;
                        var liMatters="";
                        for(var i=0; i<records.length; i++){
                            liMatters = liMatters+"\
                            <li>\n\
                                <a href='#'>\n\
                                    <h3 class='cortar'>\n\
                                        "+records[i].Materias+"\n\
                                    </h3>\n\
                                    <small class='pull-right' style='color: #00A65A'>"+records[i].Evaluado+"%</small>\n\
                                    <div style='height: 14px;' class='progress active'>\n\
                                        <div class='progress-bar progress-bar-success progress-bar-default' style='width: "+records[i].Evaluado+"%' role='progressbar' aria-valuenow='"+records[i].Evaluado+"' aria-valuemin='0' aria-valuemax='100'>\n\
                                            <span class='sr-only'>"+records[i].Evaluado+"% Complete</span>\n\
                                        </div>\n\
                                    </div>\n\
\n\                                 <span class='cortar'>\n\
                                        "+records[i].Profesor+"\n\
                                    </span>\n\
                                </a>\n\
                            </li>";
                        }
                        $(".subjectMatters").html(liMatters);
                        return records;
                    }
                });
                if(dirCookie!==null){
                    $(".content-wrapper").load("pages/"+dirCookie);
                }else{
                    $(".content-wrapper").load("pages/principal.html"); 
                }
                $('#jqxLoader').jqxLoader({text: "Cargando...", isModal: true });
                            
                $("#signOut").click(function (){
                    if(eval(localStorage.getItem("rememberMe"))){
                        localStorage.setItem("session",false);
                        window.location="login.html";
                    }else{
                        sessionStorage.setItem("session",false);
                        window.location="login.html";
                    }  
                });
                
                $(document).on("click","[data-href]",function (){
                    if($(this).attr("data-index")!=undefined){
                        sessionStorage.setItem("indexSelectedMatter", $(this).attr("data-index"));
                    }else{
                        sessionStorage.removeItem("indexSelectedMatter");
                    }
                    if($(this).attr("data-idItem")!=undefined){
                        sessionStorage.setItem("idSelectedMatter", $(this).attr("data-idItem"));
                    }else{
                        sessionStorage.removeItem("idSelectedMatter");
                    }
                    if($(this).attr("data-href")){
                        $(".treeview-menu li").removeClass("active");
                        $(this).addClass("active");
                        var myhref=$(this).attr("data-href");
                        itemClickedIdOld=localStorage.getItem("dirApp");
                        itemClickedId=myhref;
                        if(itemClickedIdOld!==itemClickedId){
                            if(navigator.vibrate) {
                                navigator.vibrate(20);
                            }
                            localStorage.setItem("dirApp",myhref);
                            if($("body").hasClass("sidebar-open")){
                                $("body").removeClass("sidebar-open");
                                $("body").addClass("sidebar-close");
                            }
                            $.ajax({
                                async: true,
                                type: 'GET',
                                url: "pages/"+$(this).attr("data-href"),
                                beforeSend: function (xhr) {     
                                    $('#jqxLoader').jqxLoader('open');
                                    $('#jqxLoader').css("left","0px","top","0px");
                                },                            
                                error: function (jqXHR, textStatus, errorThrown) {
                                    alert("Error interno del servidor");
                                    $('#jqxLoader').jqxLoader('close');
                                },
                                success: function (data, textStatus, jqXHR) {
                                    $('#jqxLoader').jqxLoader('close');
                                    $(".content-wrapper").html(data);
                                }
                            });
                        }
                    }
                });
                $(".sidebar-toggle, .dropdown-toggle, .btn, .close").click(function (){
                    if(navigator.vibrate) {
                        navigator.vibrate(20);
                    }
                });
                $(".logo").click(function (){                    
                    var myhref="principal.html";
                    itemClickedIdOld=localStorage.getItem("dirApp");
                    itemClickedId=myhref;
                    if(itemClickedIdOld!==itemClickedId){
                        localStorage.setItem("dirApp",myhref);
                        if($("body").hasClass("sidebar-open")){
                            $("body").removeClass("sidebar-open");
                            $("body").addClass("sidebar-close");
                        }
                        if(navigator.vibrate) {
                            navigator.vibrate(20);
                        }
                        $.ajax({
                            async: true,
                            type: 'GET',
                            url: "pages/"+myhref,
                            beforeSend: function (xhr) {  
                                $('#jqxLoader').jqxLoader('open');
                                $('#jqxLoader').css("left","0px","top","0px");
                            },                            
                            error: function (jqXHR, textStatus, errorThrown) {
                                alert("Error interno del servidor");
                                $('#jqxLoader').jqxLoader('close');
                            },
                            success: function (data, textStatus, jqXHR) {
                                $('#jqxLoader').jqxLoader('close');
                                $(".content-wrapper").html(data);
                            }
                        });
                    }
                });
            });
        </script>
      </body>
</html>